<!DOCTYPE html>
<html>
<head>
  <title>IBM Watson Assistant Web Chat</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="carbon-components.min.css">
  <link rel="stylesheet" href="style.css">
  <style id="template_styles">
    /* 
      CSS classes to manage your custom Web Chat launcher and the custom element
      we will render the Web Chat to.

      Animations provided by https://daneden.github.io/animate.css/
    */
    @import "https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css";

    /*
      The element we will render the Web Chat to. The Web Chat will grow to fit the full
      element, so be sure to give it a high and width.
    */

    .chatElement {
      position: fixed;
      top: 50%;
      left: 50%;
      margin-top: -40vh;
      margin-left: -40%;
      animation-duration: 0.5s;
      transition-duration: 0.5s;
      z-index: 8000;
    }

    .chatElement.opening {
      opacity: 1;
      height: 80vh;
      width: 80%;
      animation-name: bounceInDown;
    }

    .chatElement.open {
      opacity: 1;
      height: 80vh;
      width: 80%;
    }

    .chatElement.closing {
      opacity: 1;
      height: 80vh;
      width: 80%;
      animation-name: bounceOutUp;
    }

    .chatElement.close {
      opacity: 0;
      height: 0;
      width: 0;
      display: none;
    }

    /*
      The Web Chat launcher we will be using instead of the built in launcher.
    */
    
    .chatLauncher {
      animation-duration: 0.5s;
      transition-duration: 0.5s;
      position: fixed;
      bottom: 32px;
      right: 32px;
      z-index: 4;
      border: 4px solid #075cc2;
      padding: 1em;
      border-radius: 8px;
      margin: 0;
      text-decoration: none;
      background-color: #ffffff;
      color: #454545;
      font-family: sans-serif;
      font-size: 1rem;
      cursor: pointer;
      text-align: center;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 264px;
      opacity: 0;
    }
    button.chatLauncher.open {
      animation-name: slideInRight;
      opacity: 1;
    }
    button.chatLauncher:hover,
    button.chatLauncher:focus {
      background-color:rgb(225, 225, 254);
      border: 4px solid #0053ba;
    }

    button.chatLauncher:focus {
      outline: 1px solid #0053ba;
      outline-offset: -4px;
    }

    button.chatLauncher section {
      display: flex;
    }

    button.chatLauncher img {
      display: block;
      height: 64px;
      width: 64px;
      border-radius: 64px;
      border: 4px solid #0053ba;
    }

    button.chatLauncher div {
      text-align: left;
      margin-left: 1rem;
      font-size: 0.95rem;
    }

  </style>
   <script src="libs.js"></script>
   <script src="writeTemplate.js"></script>
   <script src="https://web-chat.assistant.watson.cloud.ibm.com/loadWatsonAssistantChat.js"></script>
   <script>
     const options = {
      integrationID: 'f38e21ee-d79c-4427-859c-4fdd9bbed8f1',
      region: 'us-south'
     };
   </script>
</head>
<body>
  <div class="chatElement close"></div>
  <button class="chatLauncher" style="display:none;">
  <section>
    <img src="custom_element/karen.svg" />
    <div><strong>Have questions?</strong> Talk with Karen our Virtual Assistant.</div>
  </section>
</button>
<section id="template_html">
<div class="chatElement close"></div>

<button class="chatLauncher" style="display:none;">
  <section>
    <div><strong>Have questions?</strong> Talk with Karen our Virtual Assistant.</div>
  </section>
</button>
</section>
  <script id="template_script">
    // Select your element we are going to store the Web Chat in on your page.
    // The Web Chat will take up the full dimensions of the element provided
    // here, so be sure to provide height and width styling to your custom element.
    const element = document.querySelector('.chatElement');

    // Add the element to the configuration options for Web Chat.
    options.element = element;

    // Add the configuration option to Web Chat instructing it not to use the
    // built in chat launcher. You will supply your own!
    options.showLauncher = false;

    // Select the button that we are going to use for our launcher so we can use it in
    // the animationMethods below.
    const button = document.querySelector('.chatLauncher');

    // Your functions to handle adding a removing classes to our element to control
    // your custom element holding the Web Chat joining and leaving the screen. These are
    // here as an example of what you could do.
    const animationMethods = {
      /**
      * When we have finished opening the Web Chat we add the "open" class and remove
      * event listeners for the animation to end.
      */
      onDoneOpen: function onDoneOpen() {
        element.classList.add('open');
        element.classList.remove('opening');
        element.removeEventListener('animationend', animationMethods.onDoneOpen);
      },

      /**
      * When we have finished closing the Web Chat we add the "close" class and remove
      * event listeners for the animation to end. We also re-add the "open" class to
      * our custom launcher to bring it back into view.
      */
      onDoneClose: function onDoneClose() {
        element.classList.add('close');
        element.classList.remove('closing');
        element.removeEventListener('animationend', animationMethods.onDoneClose);
        button.classList.add('open');
      },

      /**
      * When the window:open event is fired, we hide our launcher, add an event
      * listener to our element we are holding our Web Chat in for when the
      * open animation completes, and then start the opening animation.
      */
      onOpen: function onOpen() {
        button.classList.remove('open');
        element.classList.remove('open', 'close', 'opening', 'closing');
        element.addEventListener('animationend', animationMethods.onDoneOpen);
        element.classList.add('opening');
      },

      /**
      * When the window:close event is fired, we add an event listener for
      * when the closing animation completes and start the closing animation.
      */
      onClose: function onClose() {
        element.classList.remove('open', 'close', 'opening', 'closing');
        element.addEventListener('animationend', animationMethods.onDoneClose);
        element.classList.add('closing');
      }
    }
 
    // Initialize the Web Chat with the default options including your
    // integrationID, region and our updates above to options.element and
    // options.showLauncher.
    window.loadWatsonAssistantChat(options).then(function(instance){

      // When the instance of the chat is ready, we show the
      // launcher button and attach an event handler to open
      // the Web Chat.
      button.addEventListener('click', function() { instance.openWindow(); });
      button.classList.add('open');
      button.style.display = 'block';

      // We also will listen to the window:open and window:close
      // events so we can add our own custom animations to open
      // and close the chat.
      instance.on({ type: 'window:open', handler: animationMethods.onOpen });
      instance.on({ type: 'window:close', handler: animationMethods.onClose });

      // And finally, we render the Web Chat in its closed state without the built in launcher.
      instance.render();
    });
  </script>
  <script>
    const templateConfig = {
      title: 'Using a custom chat launcher and render target',
      html_content: '<p>In combination with other methods of customer contact (or to better match your brand), you may want to define a way to launch the Web Chat that is not the one provided by default. To do so, you can use the <a href="https://watson-developer-cloud.github.io/assistant-web-chat/documentation.html#configuration"><em>showLauncher</em> configuration option</a> to hide the launcher. You can then use the <a href="https://watson-developer-cloud.github.io/assistant-web-chat/documentation.html#instanceopenwindow"><em>openWindow</em> method</a> to actually open the Web Chat from your custom launcher. Be aware that the method will not actually exist until the Web Chat is loaded, so you will likely want to hide your custom launcher until load is complete as shown in this example.</p><p>You also may want to house your Web Chat in a different area of the page than the default lower right hand side. To do so, you can use the <a href="https://watson-developer-cloud.github.io/assistant-web-chat/documentation.html#configuration"><em>element</em> configuration option</a>. This will render the Web Chat to the element you provide. The Web Chat will then grow to fill the size of that element. You will be responsible for adding your own entrance and exit animations on a custom provided element.</p>',
      integrationID: options.integrationID,
      region: options.region,
      files: []
    };
    writeTemplate(templateConfig);
  </script>
</body>
</html>
